step,description,entities,previous step,time
1,Extracing race information for the cohort,person,,
2,Extracing the most frequent department information for the cohort. This is based on the department where the patient has the most physical visits. A staging table is created in this step.,person,1,
3,Extracting ethnicity information for the cohort. Assigning unknown for patients who don't have an assignment of Hispanic or Latino or Not Hispanic or Latino but were asked this question. A staging table is created in this step.,person,2,
4,"Extracting the demographic information for the cohort. This incldes getting gender, pcp, address, gestational age information from the source. A staging table is created in this step.",person,3,
5,"Extracting patient status (death information) for the cohort. This includes getting the cause of death. For patients that have a deceased status in the source, the local convention has been to extract the last known physical visit as the death date. A staging table is created in this step.",death,4,
6,Extracting information for the location to include the union of patient address location information and care site/department location information. A staging table is created in this step.,location,5,
7,Extracting care site information to include departments at CHOP but also attaining the assigned department specialty and hospital servcies offered/handled within the department A staging table is created in this step.,care_site,6,
8,Creating a care site look up table for specialty to map the standard concepts from the vocabulary.,care_site,7,
9,Extracting provider information for the cohort and provider specialty information. A staging table is created in this step.,provider,8,
10,"Extracting encounter information for the cohort. In this step Emergency department visits that result in an inpatient admission are split into two encounters. Anesthesia and OR Visits that are a part of an Inpatient visit are rolled up to the Inpatient Level. This includes rolling up to the secondary ER visit that is created beacause of the Inpatient Admission. Level of service information is also extracted where available. Visits are also assigned and grouped into particular types. Discharge disposition, admission source and discharge location information is also extracted in this step. A staging table is created in this step.","visit_occurrence,observation",9,
11,Extracting payer information for the encounters for the cohort. In this step the various payers are assinged the standard PEDSNet categories for plan type and plan class.  A staging table is created in this step.,visit_payer,10,
12,Extracting drg information for the cohort. A staging table is created in this step.,observation,11,
13,"Extraction tobacco information for the cohort, A staging table is created in this step.",observation,12,
14,Extracting problem list diagnosis information for the cohort. Only active or resolved problems are included. A staging table is created in this step.,condition_occurrence,13,
15,Extracting outpatient and ED diagnosis information for the cohort. A staging table is created in this step.,condition_occurrence,14,
16,Extracting inpatient diagnosis information for the cohort. A staging table is created in this step.,condition_occurrence,15,
17,Extracting procedure information for the cohort.  A staging table is created in this step.,procedure_occurrence,16,
18,Extracting blood pressure information for the cohort. The systolic and diastolic values are split to enable the program to report diastolic and systolic as separate values.  A staging table is created in this step.,measurement,17,
19,Extracting height and weight information for the cohort. A staging table is created in this step.,measurement,18,
20,Extracting outpatient medication order information for the cohort. A staging table is created in this step.,drug_exposure,19,
21,Extracting inpatient medication administration information for the cohort. All administration information is rolled up to create one row per inpatient medication. A staging table is created in this step.,drug_exposure,20,
22,Extracting dispensed medication order information for the cohort. A staging table is created in this step.,drug_exposure,21,
23,Extacting lab information for the cohort. A staging table is created in this step.,measurement,22,
24,Updating the location staging table to include a generic location for CHOP (used in cases for care sites that do not have a location).,location,23,
25,Updating the care site staging stable to map a location id from the location staging table for the care site ,care_site.location_id,24,
26,Updating the care site staging table to include a generic care site for CHOP (used in cases for patients that do not have a location assigned).,care_site,25,
27,Updating the care site staging table to map the department's specialty or service offered based on the specialty mapping table created above.,care_site.specialty_concept_id,26,
28,Updating the provider staging table to map a care site to a provider based on their care site assignment in the source,provider.care_site_id,27,
29,Updating the provider staging table to map to the generic care site where they do not have a care site assignment in the source or an unmapped care site,provider.care_site_id,28,
30,Updating the provider statging table to map the provider's specialty based on their assignment in the source.,provider.specialty_concept_id,29,
31,Updating the person staging table to map the patients race to the standard vocabulary,person.race_concept_id,30,
32,Updating the person staging table to map the patients ethnicity to the standard vocabulary,person.ethnicity_concept_id,31,
33,Updating the death staging table to map the cause of death (ICD9) to the transform in the standard vocabulary  to SNOMED,death.cause_concept_id,32,
34,Updating the death staging table to map the cause of death (ICD9) to the standard vocabulary for ICD9,death.cause_source_concept_id,33,
35,Updating the encounter staging table to map the encounter's visit type to the standard vocabulary,visit_occurrence.visit_concept_id,34,
36,"Updating the encounter staging table to map the encounter's care site to a care site in the care_site staging table, based on the associated deparment and specialty or service offered at the time.",visit_occurrence.care_site_id,35,
37,Updating the encounter staging table to map the encounter's provider to a provider in the provider stating table,visit_occurrence.provider_id,36,
38,Updating the encounter table to map the encounter's level of service to a CPT4 Standard Concept. For code longer than 5 digits (Eg. 55555.999 - Unique to CHOP) the decimal is striped to match on 5 digit CPT code within the vocabulary.,procedure_occurrence.procedure_concept_id,37,
39,"Updating the visit payer staging table to map to the applicable encounter (logic crucial determining associateion with  Outpatient, ED and/or Inpatient encounter)",visit_payer.visit_occurrence_id,38,
40,Updating the care site staging table to map the place of service concept id using the logic the most common type of service offered as its assignment). ,care_site.place_of_service_concept_id,39,
41,Updating the problem list staging table to map a provider from the provider staging table based on who entered the diagnosis on the problem list ,condition_occurrence.provider_id,40,
42,Updating the problem list staging table to map the problem list diagnosis (ICD9) to the transform in the standard vocabulary to SNOMED,condition_occurrence.condition_concept_id,41,
43,Updating the problem list staging table to map the condition type to reflect the problem list mapping from the standard vocabulary,condition_occurrence.condition_source_concept_id,42,
44,Updating the outpatient and ed condition staging table to map a provider from the provider staging table based on who was responsible for the visit,condition_occurrence.provider_id,43,
45,Updating the outpatient and ed condition staging table for the correct encounter from the encounter staging table,condition_occurrence.visit_occurrence_id,44,
46,Updating the outpatient and ed condition staging table to map the problem list diagnosis (ICD9) to the transform in the standard vocabulary to SNOMED,condition_occurrence.condition_concept_id,45,
47,Updating the outpatient and ed condition staging table to map the condition type to reflect the diagnosis as primary for the primary diagnsos and seconday for all others based on mapping from the standard vocabulary,condition_occurrence.condition_source_concept_id,46,
48,Updating the hospital condition staging table to map a provider from the provider staging table based on who was responsible for the visit,condition_occurrence.provider_id,47,
49,Updating the hospital condition staging table for the correct encounter from the encounter staging table,condition_occurrence.visit_occurrence_id,48,
50,Updating the hospital condition staging table to map the problem list diagnosis (ICD9) to the transform in the standard vocabulary to SNOMED,condition_occurrence.condition_concept_id,49,
51,Updating the hospital condition staging table to map the condition type to reflect the diagnosis as primary for the primary diagnsos and seconday for all others based on mapping from the standard vocabulary,condition_occurrence.condition_source_concept_id,50,
52,Updating the procedure staging table to map the CPT for the procedure to a CPT4 Standard Concept. For code longer than 5 digits (Eg. 55555.999 - Unique to CHOP) the decimal is striped to match on 5 digit CPT code within the vocabulary.,procedure_occurrence.procedure_concept_id,51,
53,Updating the procedure staging table to map the HCPCS code from the standard vocabulary for EPSDT procedures ,procedure_occurrence.procedure_concept_id,52,
54,Updating the procedure staging table to map the procedure type for procedure orders,procedure_occurrence.procedure_type_concept_id,53,
55,Updating the procedure staging  table to map the provider who authorized the procedure from the provider staging table,procedure_occurrence.provider_id,54,
56,Updating the procedure staging table to map the correct encounter associated with the procedure order,procedure_occurrence.visit_occurrence_id,55,
57,Updating the drg staging table to map the code for DRGs from the standard vocabulary,observation.observation_concept_id,56,
58,Updating the drg staging table to map the type of observation for DRGs,observation.observation_type_concept_id,57,
59,Updating the drg staging table to map the DRG code (DRG and MSDRG) to a map to a standard code in the vocabulary,observation.value_as_concept_id,58,
60,Upating the tobacco staging table to include the tobacco type and smoking standard concepts,observation.value_as_concept_id,59,
61,Updating the blood pressure staging table to map the provider resposible for entering the measurement from the provider staging table,measurement.provider_id,60,
62,Updating the blood pressure staging table to map the applicable encounter,measurement.visit_occurrence_id,61,
63,Updating the blood pressure staging table to map the measurement concept for systolic and diastolic from the standard vocabulary,measurement.measurement_concept_id,62,
64,Updating the blood pressure staging table to map the measurement type concept that applies to vitals for systolic and diastolic from the standard vocabulary,measurement.measurement_type_concept_id,63,
65,Updating the blood pressure staging table to map the applicable units,measurement.unit_concept_id,64,
66,Updating the vitals(height and weight) staging table to map the provider resposible for entering the measurement from the provider staging table,measurement.provider_id,65,
67,Updating the vitals(height and weight) staging table to map the applicable encounter,measurement.visit_occurrence_id,66,
68,Updating the vitals(height and weight) staging table to map the measurement concept for height and weight from the standard vocabulary,measurement.measurement_concept_id,67,
69,Updating the vitals(height and weight) staging table to map the measurement type concept that applies to vitals for height and weight from the standard vocabulary,measurement.measurement_type_concept_id,68,
70,Updating the vitals(height and weight) staging table to map the applicable units,measurement.unit_concept_id,69,
71,Updating the outpatient prescrption staging table to map the medication source code (GPI) to the transform in the standard vocabulary to RxNorm,drug_exposure.drug_concept_id,70,
72,Updating the outpatient prescrption staging table to map the medication source code (GPI) to the standard vocabulary,drug_exposure.drug_source_concept_id,71,
73,Updating the outpatient prescrption staging table to map the applicable encounter,drug_exposure.visit_occurrence_id,72,
74,Updating the outpatient prescrption staging  table to map the provider resposible for the prescription from the provider staging table,drug_exposure.provider_id,73,
75,Creating a reference table to obtain the most recent weight (within 60 days) for each order,drug_exposure,74,
76,Updating the outpatient prescription staging table for effective dose by calcualting the effective dose based on weight dose basing or using a vaue from the source if it is already in weight dose format. During this step integers can be converted to roll up to a higher value.,drug_exposure.effective_drug_dose,75,
77,Updating the outpatient prescription staging table to extract  and standardize the dose unit applicable to the effective dose,drug_exposure.dose_unit_concept_id,76,
78,Updating the outpatient prescription staging table to map the outpatient prescription type from the standard vocabulary,drug_exposure.drug_type_concept_id,77,
79,Updating the outpatient prescription staging table to map the dose unit for the unit in the source value,drug_exposure.dose_unit_concept_id,78,
80,Updating the outpatient prescription staging table to map the route for the drug to a code within the standard vocabulary,drug_exposure.route_concept_id,79,
81,Updating the inpatient prescription staging table to map the medication source code (GPI) to the transform in the standard vocabulary to RxNorm,drug_exposure.drug_concept_id,80,
82,Updating the inpatient prescription staging table to map the medication source code (GPI) to the standard vocabulary,drug_exposure.drug_source_concept_id,81,
83,Updating the inpatient prescription staging table to map the applicable encounter,drug_exposure.visit_occurrence_id,82,
84,Updating the inpatient prescription staging  table to map the provider resposible for the prescription from the provider staging table,drug_exposure.provider_id,83,
85,Creating a reference table to obtain the most recent weight (within 60 days) for each order,drug_exposure,84,
86,Updating the inpatient prescription staging table for effective dose by calcualting the effective dose based on weight dose basing or using a vaue from the source if it is already in weight dose format. During this step integers can be converted to roll up to a higher value.,drug_exposure.effective_drug_dose,85,
87,Updating the inpatient prescription staging table to extract  and standardize the dose unit applicable to the effective dose,drug_exposure.dose_unit_concept_id,86,
88,Updating the inpatient prescription staging table to map the dose unit for the unit in the source value,drug_exposure.dose_unit_concept_id,87,
89,Updating the inpatient prescription staging table to map the route for the drug to a code within the standard vocabulary,drug_exposure.route_concept_id,88,
90,Updating the inpatient prescription staging table to map the inpatient administration type from the standard vocabulary,drug_exposure.drug_type_concept_id,89,
91,Updating the dispensed medication staging table to map the medication source code (NDC) to the transform in the standard vocabulary to RxNorm,drug_exposure.drug_concept_id,90,
92,Updating the dispensed medication staging table to map the medication source code (NDC) to the standard vocabulary,drug_exposure.drug_source_concept_id,91,
93,Updating the dispensed medication staging table to map the applicable encounter,drug_exposure.visit_occurrence_id,92,
94,Updating the dispensed medication staging  table to map the provider resposible for the prescription from the provider staging table,drug_exposure.provider_id,93,
95,Creating a reference table to obtain the most recent weight (within 60 days) for each order,drug_exposure,94,
96,Updating the dispensed medication staging table for effective dose by calcualting the effective dose based on weight dose basing or using a vaue from the source if it is already in weight dose format. During this step integers can be converted to roll up to a higher value.,drug_exposure.effective_drug_dose,95,
97,Updating the dispensed medication staging table to extract  and standardize the dose unit applicable to the effective dose,drug_exposure.dose_unit_concept_id,96,
98,Updating the dispensed medication staging table to map the dose unit for the unit in the source value,drug_exposure.dose_unit_concept_id,97,
99,Updating the dispensed medication staging table to map the dispensed medication type from the standard vocabulary,drug_exposure.drug_type_concept_id,98,
100,Updating the labs staging table to map the operators if the lab string value contain them,measurement.operator_concept_id,99,
101,Updating the labs staging table to extract the numeric value from the lab string value to be converted into decimals and intergers,measurement.value_as_number,100,
102,Updating the labs staging table to map the measurement type assocaited with lab orders from the standard vocabulary,measurement.measurement_type_concept_id,101,
103,Updating the labs staging  table to map the provider who authorized the labs from the provider staging table,measurement.provider_id,102,
104,Updating the labs staging table to map the applicable unit values for the lab result,measurement.unit_concept_id,103,
105,Updating the labs staging table to match and extract qualitative lab result data (negative vs positive),measurement.value_as_concept_id,104,
106,Updating the labs staging table by mapping the extracted qualtiive lab result data to a standard concept within the vocabulary,measurement.value_as_concept_id,105,
107,Updating the labs staging table to map the applicable encounter,measurement.visit_occurrence_id,106,
108,Updating the labs staging table to map the CPT for the labs to a CPT4 Standard Concept. For code longer than 5 digits (Eg. 55555.999 - Unique to CHOP) the decimal is striped to match on 5 digit CPT code within the vocabulary.,measurement.measurement_source_concept_id,107,
109,Updating the labs staging table to map the local code to the PEDSNet loinc code using a developed mapping,measurement.measurement_concept_id,108,
110,Inserting records into the location table from the location staging table,location,109,
111,Inserting records into the care site table from the care site staging table,care_site,110,
112,Inserting records into the provider table from the provider staging table,provider,111,
113,"Inserting records into the person table with information from joining the race,ehtnicity,most frequent department, location, care site and provider staging tables",person,112,
114,Inserting records into the death table from the death staging table,death,113,
115,Inserting records into the visit occurrence table from the encounter staging table,visit_occurrence,114,
116,Inserting records into the fact relationship table from the encounter staging table to link ER and Inpatient visits that had to be split as a result of the convention,fact_relationship,115,
117,Inserting records into the visit payer table from the visit payer staging table,visit_payer,116,
118,Inserting records into the condition occurrence table from the problem list staging table,condition_occurrence,117,
119,Inserting records into the condition occurrence table from the outpatient and ED Condition staging table,condition_occurrence,118,
120,Inserting records into the condition occurrence table from the inpatient Condition staging table,condition_occurrence,119,
121,Inserting records into the procedure table from the procedure staging table,procedure_occurrence,120,
122,Inserting records into the procedure table from the encounter staging table by extracting the level of service procedures that were previously mapped,procedure_occurrence,121,
123,Isnerting records into the observation table from the encounter staging table by extracting the discharge disposition information,observation,122,
124,Isnerting records into the observation table from the encounter staging table by extracting the admission source information,observation,123,
125,Inserting records into the observation table from the encounter staging table by extracting the discharge destination information,observation,124,
126,Inserting records into the observation table from the tobacco staging table,observation,125,
127,Inserting records into the observation table from the drg staging table,observation,126,
128,Inserting records into the measurement table from the blood pressure and vitals (height and weight) staging  table,measurement,127,
129,Inserting records into the fact relationship table from the blood pressurestaging table to link systolic and diastolic blood pressures that had to be split as a result of the convention,fact_relationship,128,
130,Inserting records into the drug exposure table from the outpatient prescription staging table,drug_exposure,129,
131,Inserting records into the drug exposure table from the inpatient administration staging table,drug_exposure,130,
132,Inserting records into the drug exposure table from the dispensed medication staging table,drug_exposure,131,
133,Inserting records into the measurement table from the labs staging table,measurement,132,
